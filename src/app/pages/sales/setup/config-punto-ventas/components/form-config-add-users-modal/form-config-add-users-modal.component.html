<nb-card [nbSpinner]="loadingSpinnerSave" nbSpinnerStatus="primary">
  <nb-card-header class="d-flex justify-content-between align-items-center">
    <div></div>
    <div> Agregar usuarios</div>
    <button nbButton ghost status="basic" size="tiny" (click)="onClose()" nbTooltip="Cerrar">
      <nb-icon icon="close-outline"></nb-icon>
    </button>
  </nb-card-header>

  <nb-card-body class="">

    <form [formGroup]="newForm">
      <div class="row">
        <div class="col-md-12">
          <div class="mb-2">
            <label for="id_user" class="label required">Usuario <small *ngIf="loadingUsers">Cargando...</small></label>
            <nb-form-field>
              <nb-icon nbPrefix icon="search-outline" pack="eva"></nb-icon>
              <input #idUserSearch autocomplete="off" nbInput type="search" placeholder="Buscar..." fullWidth
                shape="round" fieldSize="small" [formControl]="textSearchUser" [nbAutocomplete]="autoControlUser" />
            </nb-form-field>
            
            <nb-autocomplete #autoControlUser size="small" [activeFirst]="true" [handleDisplayFn]="viewHandleUser"
              (selectedChange)="selectedChangeUser($event)">
              <nb-option *ngFor="let item of filteredUserList$ | async" [value]="item">
                {{ item?.email }}
              </nb-option>
            </nb-autocomplete>
          </div>
        </div>
      </div>
    </form>


  </nb-card-body>

  <nb-card-footer class="d-flex justify-content-center">
    <button nbButton class="me-1" status="basic" size="small" (click)="onClose()">
      <nb-icon icon="close-outline"></nb-icon>
      <span class="ms-1">Cerrar</span>
    </button>

    <button nbButton class="me-1" status="primary" size="small" (click)="onSave()">
      <nb-icon icon="save-outline"></nb-icon>
      Guardar
    </button>

  </nb-card-footer>
</nb-card>