<nb-card [nbSpinner]="loadingSpinnerSave" nbSpinnerStatus="primary" status="primary">
  <nb-card-header class="d-flex justify-content-between">
    <div></div>
    <div class="text-center">
      GENERAR CAJA DIARIA
    </div>
    <div>
      <nb-icon icon="close-outline" (click)="onClose()" style="cursor: pointer"></nb-icon>
    </div>
  </nb-card-header>
  <nb-card-body>
    <form [formGroup]="documentoForm">

      <div class="row">
        <div class="col-md-12">
          <div class="mb-2">
            <label for="id_caja" class="label form-label">Cajas disponibles</label>
            <nb-select placeholder="Caja disponibles" fullWidth [size]="'small'" formControlName="id_caja" id="id_caja">
              <nb-option *ngFor="let item of misPuntoVentasCajas$ | async" [value]="item.id_caja">
                <div class="d-flex flex-column lh-base">
                  <span class="fw-medium">{{ item.nombre }}</span>
                  <small class="fw-normal">{{ item.medio_pago_nombre }} ({{ item.moneda_currency }})</small>
                </div>
              </nb-option>
            </nb-select>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-2">
          <label for="id_anho" class="label required">Año</label>
          <nb-select placeholder="Año" fullWidth [size]="'small'" formControlName="id_anho" id="id_anho">
            <nb-option *ngFor="let item of anhos$ | async" [value]="item.id_anho">
              {{ item.id_anho }} </nb-option>
          </nb-select>
        </div>
        <div class="col-md-6 mb-2">
          <label for="id_mes" class="label required">Mes</label>
          <nb-select placeholder="Año" fullWidth [size]="'small'" formControlName="id_mes" id="id_mes">
            <nb-option *ngFor="let item of meses$ | async" [value]="item.id_mes">
              {{ item.nombre }}
            </nb-option>
          </nb-select>
        </div>
      </div>

      <div class="row g-1">
        <div class="col-md-12 mb-2">
          <label for="id_responsable" class="label required">Responsable</label>
          <nb-form-field>
            <nb-icon nbPrefix icon="search-outline" pack="eva"></nb-icon>
            <input #idUserSearch autocomplete="off" nbInput type="search" placeholder="Buscar..." fullWidth
              shape="round" fieldSize="small" [formControl]="textSearchUser" [nbAutocomplete]="autoControlUser" />
          </nb-form-field>

          <nb-autocomplete #autoControlUser size="small" [activeFirst]="true" [handleDisplayFn]="viewHandleUser"
            (selectedChange)="selectedChangeUser($event)">
            <nb-option *ngFor="let item of filteredUserList$ | async" [value]="item">
              {{ item?.email }}
            </nb-option>
          </nb-autocomplete>
        </div>
      </div>

      <div class="row g-1">
        <div class="col-md-6 mb-2">
          <label for="fecha_apertura" class="label required">Fecha apertura</label>
          <nb-form-field>
            <input type="text" autocomplete="off" name="fecha_apertura" placeholder="00/00/0000" id="fecha_apertura"
              formControlName="fecha_apertura" [nbDatepicker]="nfecha22" fullWidth fieldSize="small" nbInput>
            <nb-icon nbSuffix icon="calendar-outline" pack="eva"></nb-icon>
          </nb-form-field>
          <nb-datepicker #nfecha22></nb-datepicker>
        </div>
        <div class="col-md-6 mb-2">
          <label for="importe" class="label required">Importe</label>
          <input type="number" nbInput fullWidth fieldSize="small" name="importe" id="importe" formControlName="importe"
            placeholder="0.00">
        </div>
      </div>

    </form>

  </nb-card-body>
  <nb-card-footer class="text-end">
    <button nbButton class="me-1" status="basic" size="small" (click)="onClose()">
      <nb-icon icon="close-outline"></nb-icon>
      Cancelar
    </button>

    <button nbButton class="me-1" status="primary" size="small" (click)="onSave()">
      <nb-icon icon="save-outline"></nb-icon>
      Registrar apertura
    </button>

  </nb-card-footer>
</nb-card>