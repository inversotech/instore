<nb-card [nbSpinner]="loadingSpinner" nbSpinnerStatus="primary" status="primary">
  <nb-card-body>
    <form [formGroup]="filterForm" (ngSubmit)="submitFormSearch()">
      <div class="row mb-2">
        <div class="col-md-3">
          <div class="mb-2">
            <label for="anho_id" class="label required">Año</label>
            <nb-select placeholder="Año" size="small" formControlName="anho_id" fullWidth name="anho_id" id="anho_id">
              <nb-option value="">-Seleccione-</nb-option>
              <nb-option *ngFor="let item of anhos" [value]="item.anho_id"> {{ item.anho_id }} </nb-option>
            </nb-select>
          </div>
        </div>
        <div class="col-md-6">
          <label for="anho_id" class="label" style="visibility: hidden;">.</label>
          <nb-form-field>
            <nb-icon nbPrefix icon="search-outline" pack="eva"></nb-icon>
            <input formControlName="text_search" type="search" placeholder="Buscar..." nbInput fullWidth shape="round"
              fieldSize="small">
          </nb-form-field>
        </div>
        <div class="col-md-3">
          <label class="label" style="visibility: hidden;">.</label>
          <div>
            <button nbButton class="me-1" type="submit" status="primary" size="small">
              <nb-icon nbPrefix icon="search-outline" pack="eva"></nb-icon>
              Buscar
            </button>
            <button nbButton class="me-1" type="button" status="primary" size="small" (click)="onRegistrarNuevo()">
              <nb-icon icon="plus-outline"></nb-icon>
              Agregar
            </button>
          </div>
        </div>
      </div>
    </form>

    <table class="table table-sm">
      <thead>
        <tr>
          <th>GRUPO</th>
          <th>SEGMENTO / FAMILIA / CLASE / PRODUCTO</th>
          <th>ARTÍCULO O ITEM</th>
          <th>DETALLE</th>
          <th class="text-center">ACCIONES</th>
        </tr>
      </thead>
      <tbody *ngIf="almacenArticulos.length > 0; else emptyList">
        <tr *ngFor="let item of almacenArticulos | paginate: { id: 'almacenArticuloPaginate',
        itemsPerPage: pagination.pageSize,
        currentPage: pagination.currentPage,
        totalItems: pagination.totalItems}">
          <td style="line-height: 1rem;">
            <div>
              <span [nbTooltip]="item.g_articulo_nombre" class="fw-bold">[{{item.g_articulo_codigo}}]</span>
            </div>
          </td>
          <td style="line-height: 0.9rem;">
            <div>
              [S] {{item.s_articulo_codigo}} - {{item.s_articulo_nombre}}
            </div>
            <div>
              [F] {{item.f_articulo_codigo}} - {{item.f_articulo_nombre}}
            </div>
            <div>
              [C] {{item.c_articulo_codigo}} - {{item.c_articulo_nombre}}
            </div>
            <div>
              [P] {{item.p_articulo_codigo}} - {{item.p_articulo_nombre}}
            </div>
          </td>
          <td style="line-height: 0.9rem;">
            <div class="fw-bold">
              [I] {{item.i_articulo_codigo}} - {{item.i_articulo_nombre}}
            </div>
            <div>
              <span>Código de almacén: {{item.codigo_almacen}}</span>
            </div>
            <div>
              <span>Tipo: {{item.es_servicio ? 'Servicio' : 'Producto'}}</span>
            </div>
            <div>
              <span *ngIf="item.activo">
                <nb-icon status="success" icon="done-all-outline"></nb-icon> Activo
              </span>
              <span *ngIf="!item.activo">
                <nb-icon status="danger" icon="slash-outline"></nb-icon>Desactivo
              </span>
            </div>
          </td>
          <td style="line-height: 0.9rem;">
            <div>
              <strong>Stock Mínimo: {{item.stock_minimo}}, Stock Actual: {{item.stock_actual}}</strong>
            </div>
            <div>
              Tipo igv: {{item.tipo_igv_id}}-{{item.tipo_igv_descripcion}}
            </div>
            <div>
              Costo: {{item.costo}}
            </div>
            <div>
              Costo Total: {{item.costo_total}}
            </div>
          
          </td>
          <td class="text-center">
            <button nbButton class="me-1" size="tiny" (click)="onUpdate(item)" nbTooltip="Editar">
              <nb-icon status="primary" icon="edit-outline"></nb-icon>
            </button>
            <button nbButton class="me-1" size="tiny" (click)="onEliminar(item)" nbTooltip="Eliminar">
              <nb-icon status="danger" icon="trash-outline"></nb-icon>
            </button>
          </td>
        </tr>


      </tbody>
      <tfoot>
        <tr>
          <td>Total: {{ pagination.totalItems }} </td>
          <td colspan="4" class="text-center">
            <pagination-controls class="lamb-pagination" id="almacenArticuloPaginate" (pageChange)="pageChanged($event)"
              (pageBoundsCorrection)="pageChanged($event)" [maxSize]="paginationControls.maxSize"
              [directionLinks]="paginationControls.directionLinks" [responsive]="paginationControls.responsive"
              previousLabel="ANTERIOR" nextLabel="SIGUIENTE" [autoHide]="paginationControls.autoHide"
              screenReaderPaginationLabel="Pagination" screenReaderPageLabel="page"
              screenReaderCurrentLabel="Estás en la página">
            </pagination-controls>
          </td>
        </tr>
      </tfoot>
    </table>

    <ng-template #emptyList>
      <tbody>
        <tr>
          <td colspan="5" class="text-center label">
            No hay registros para mostrar
          </td>
        </tr>
      </tbody>
    </ng-template>


  </nb-card-body>
  <nb-card-footer class="text-end open-button-end">
    <!-- <button nbButton status="primary" size="small" (click)="onSave()" >
      <nb-icon icon="save-outline"></nb-icon>
      Guardar
    </button> -->
  </nb-card-footer>
</nb-card>